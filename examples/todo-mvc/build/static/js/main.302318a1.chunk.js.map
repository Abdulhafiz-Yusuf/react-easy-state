{"version":3,"sources":["todosStore.js","TodoItem.jsx","App.jsx","index.js","../../../dist/es.es6.js"],"names":["todos","store","all","filter","isEmpty","length","completed","todo","hasCompleted","allCompleted","every","forEach","active","create","title","push","remove","id","splice","toggle","toggleAll","clearCompleted","TodoItem","_this","props","this","_this$props","_this$props$completed","itemClass","classNames","view","react_default","a","createElement","className","type","checked","onChange","onClick","Component","App","changeFilter","ev","target","value","createTodo","keyCode","todosClass","selected","completedClass","activeClass","onKeyUp","placeholder","autoFocus","htmlFor","map","idx","src_TodoItem","Object","assign","key","ReactDOM","render","src_App","document","getElementById","global","__webpack_require__","d","__webpack_exports__","_Users_miklosbertalan_react_easy_state_examples_todo_mvc_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__","_Users_miklosbertalan_react_easy_state_examples_todo_mvc_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__","_Users_miklosbertalan_react_easy_state_examples_todo_mvc_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__","_Users_miklosbertalan_react_easy_state_examples_todo_mvc_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__","_Users_miklosbertalan_react_easy_state_examples_todo_mvc_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__","_Users_miklosbertalan_react_easy_state_examples_todo_mvc_node_modules_babel_runtime_helpers_esm_get__WEBPACK_IMPORTED_MODULE_5__","_Users_miklosbertalan_react_easy_state_examples_todo_mvc_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__","_Users_miklosbertalan_react_easy_state_examples_todo_mvc_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_7__","react__WEBPACK_IMPORTED_MODULE_8__","_nx_js_observer_util__WEBPACK_IMPORTED_MODULE_9__","globalObj","tasks","Set","isStopped","batchCallbacks","fn","_len","arguments","args","Array","_key","batchedArgs","arg","_len2","_key2","batch","apply","runTask","clear","task","window","setTimeout","setInterval","requestAnimationFrame","requestIdleCallback","Promise","prototype","then","catch","WebSocket","method","obj","descriptor","getOwnPropertyDescriptor","newDescriptor","set","batched","_len3","_key3","call","defineProperty","batchMethod","COMPONENT","Symbol","DUMMY_STATE","Comp","rawDevtool","undefined","devtool","isStatelessComp","isReactComponent","BaseComp","operation","ReactiveHOC","_BaseComp","context","state","updater","setState","scheduler","add","delete","debugger","lazy","nextProps","nextState","renderType","keys","nextKeys","some","oldProps","_get2","stores","component","mapStateToStores","concat","displayName","name","_arr","_i"],"mappings":"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","file":"static/js/main.302318a1.chunk.js","sourcesContent":["import { store } from 'react-easy-state'\n\n// a complex global store with a lot of derived data (getters and setters)\n// use 'todos' instead of 'this' in the store methods to make them passable as callbacks\nconst todos = store({\n  all: [],\n  filter: 'all',\n  get isEmpty () {\n    return todos.all.length === 0\n  },\n  get completed () {\n    return todos.all.filter(todo => todo.completed)\n  },\n  get hasCompleted () {\n    return todos.completed.length !== 0\n  },\n  get allCompleted () {\n    return todos.all.every(todo => todo.completed)\n  },\n  set allCompleted (completed) {\n    todos.all.forEach(todo => {\n      todo.completed = completed\n    })\n  },\n  get active () {\n    return todos.all.filter(todo => !todo.completed)\n  },\n  create (title) {\n    todos.all.push({ title })\n  },\n  remove (id) {\n    todos.all.splice(id, 1)\n  },\n  toggle (id) {\n    const todo = todos.all[id]\n    todo.completed = !todo.completed\n  },\n  toggleAll () {\n    todos.allCompleted = !todos.allCompleted\n  },\n  clearCompleted () {\n    todos.all = todos.active\n  }\n})\n\nexport default todos\n","import React, { Component } from 'react'\nimport classNames from 'classnames'\nimport { view } from 'react-easy-state'\nimport todos from './todosStore'\n\nclass TodoItem extends Component {\n  remove = () => {\n    todos.remove(this.props.id)\n  };\n\n  toggle = () => {\n    todos.toggle(this.props.id)\n  };\n\n  // render is triggered whenever the relevant parts of the component props or global todos store change\n  render () {\n    const { toggle, remove } = this\n    const { title, completed = false } = this.props\n\n    const itemClass = classNames({ view: true, completed })\n\n    return (\n      <li className={itemClass}>\n        <input\n          className='toggle'\n          type='checkbox'\n          checked={completed}\n          onChange={toggle}\n        />\n        <label>{title}</label>\n        <button onClick={remove} className='destroy' />\n      </li>\n    )\n  }\n}\n\n// wrap the component with view() before exporting it\nexport default view(TodoItem)\n","import React, { Component } from 'react'\nimport classNames from 'classnames'\nimport { view } from 'react-easy-state'\nimport TodoItem from './TodoItem'\nimport todos from './todosStore'\n\n// render is triggered whenever the relevant parts of the global todos store change\nclass App extends Component {\n  changeFilter = ev => {\n    todos.filter = ev.target.value\n  };\n\n  // create a todo on Enter key press\n  createTodo = ev => {\n    if (ev.keyCode === 13 && ev.target.value) {\n      todos.create(ev.target.value)\n      ev.target.value = ''\n    }\n  };\n\n  render () {\n    const {\n      isEmpty,\n      hasCompleted,\n      allCompleted,\n      active,\n      filter,\n      toggleAll,\n      clearCompleted\n    } = todos\n\n    const todosClass = classNames({ selected: filter === 'all' })\n    const completedClass = classNames({ selected: filter === 'completed' })\n    const activeClass = classNames({ selected: filter === 'active' })\n\n    return (\n      <div className='todoapp'>\n        <header className='header'>\n          <h1>todos</h1>\n          <input\n            onKeyUp={this.createTodo}\n            className='new-todo'\n            placeholder='What needs to be done?'\n            autoFocus\n          />\n        </header>\n\n        {!isEmpty && (\n          <section className='main'>\n            <input\n              className='toggle-all'\n              type='checkbox'\n              checked={allCompleted}\n              onChange={toggleAll}\n            />\n            <label htmlFor='toggle-all'>Mark all as complete</label>\n            <ul className='todo-list'>\n              {todos[filter].map((todo, idx) => (\n                <TodoItem {...todo} id={idx} key={idx} />\n              ))}\n            </ul>\n          </section>\n        )}\n\n        {!isEmpty && (\n          <footer className='footer'>\n            <span className='todo-count'>{active.length} items left</span>\n            <div className='filters'>\n              <button\n                className={todosClass}\n                value='all'\n                onClick={this.changeFilter}\n              >\n                All\n              </button>\n              <button\n                className={activeClass}\n                value='active'\n                onClick={this.changeFilter}\n              >\n                Active\n              </button>\n              <button\n                className={completedClass}\n                value='completed'\n                onClick={this.changeFilter}\n              >\n                Completed\n              </button>\n            </div>\n            {hasCompleted && (\n              <button className='clear-completed' onClick={clearCompleted}>\n                Clear completed\n              </button>\n            )}\n          </footer>\n        )}\n      </div>\n    )\n  }\n}\n\n// wrap the component with view() before exporting it\nexport default view(App)\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n","import _toConsumableArray from \"/Users/miklosbertalan/react-easy-state/examples/todo-mvc/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/miklosbertalan/react-easy-state/examples/todo-mvc/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/miklosbertalan/react-easy-state/examples/todo-mvc/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/miklosbertalan/react-easy-state/examples/todo-mvc/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/miklosbertalan/react-easy-state/examples/todo-mvc/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _get from \"/Users/miklosbertalan/react-easy-state/examples/todo-mvc/node_modules/@babel/runtime/helpers/esm/get\";\nimport _inherits from \"/Users/miklosbertalan/react-easy-state/examples/todo-mvc/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/miklosbertalan/react-easy-state/examples/todo-mvc/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport { Component } from 'react';\nimport { observe, unobserve, raw, isObservable } from '@nx-js/observer-util';\nexport { observable as store } from '@nx-js/observer-util';\nvar tasks = new Set();\nvar isStopped = false;\n\nfunction _add(task) {\n  if (isStopped) {\n    tasks.add(task);\n  } else {\n    runTask(task);\n  }\n}\n\nfunction remove(task) {\n  tasks.delete(task);\n} // this replaces the passed function with a function\n// that batches all of its callback arguments\n\n\nfunction batchCallbacks(fn) {\n  return function batchedCallbacks() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    var batchedArgs = args.map(function (arg) {\n      return typeof arg === 'function' ? function () {\n        for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n          args[_key2] = arguments[_key2];\n        }\n\n        return batch(arg, args);\n      } : arg;\n    });\n    return fn.apply(this, batchedArgs);\n  };\n} // bathes obj.onevent = fn like calls\n\n\nfunction batchMethod(obj, method) {\n  var descriptor = Object.getOwnPropertyDescriptor(obj, method);\n  var newDescriptor = Object.assign({}, descriptor, {\n    set: function set(value) {\n      var batched = typeof value === 'function' ? function () {\n        for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n          args[_key3] = arguments[_key3];\n        }\n\n        return batch(value, args);\n      } : value;\n      return descriptor.set.call(this, batched);\n    }\n  });\n  Object.defineProperty(obj, method, newDescriptor);\n} // this runs the passed function and delays all re-renders\n// until the function is finished running\n\n\nfunction batch(fn, args) {\n  try {\n    isStopped = true;\n    return fn.apply(this, args);\n  } finally {\n    tasks.forEach(runTask);\n    tasks.clear();\n    isStopped = false;\n  }\n}\n\nfunction runTask(task) {\n  task();\n} // try to find the global object\n// it is window in the DOM and global in NodeJS and React Native\n\n\nvar globalObj;\n\nif (typeof window !== 'undefined') {\n  globalObj = window;\n} else if (typeof global !== 'undefined') {\n  globalObj = global;\n} // do a sync batching for the most common task sources\n// this should be removed when React's own batching is improved in the future\n\n\nif (globalObj) {\n  globalObj.setTimeout = batchCallbacks(globalObj.setTimeout);\n  globalObj.setInterval = batchCallbacks(globalObj.setInterval);\n\n  if (globalObj.requestAnimationFrame) {\n    globalObj.requestAnimationFrame = batchCallbacks(globalObj.requestAnimationFrame);\n  }\n\n  if (globalObj.requestIdleCallback) {\n    globalObj.requestIdleCallback = batchCallbacks(globalObj.requestIdleCallback);\n  } // eslint-disable-next-line\n\n\n  Promise.prototype.then = batchCallbacks(Promise.prototype.then); // eslint-disable-next-line\n\n  Promise.prototype.catch = batchCallbacks(Promise.prototype.catch); // this batches websocket event handlers\n\n  if (globalObj.WebSocket) {\n    var websocketHandlers = ['onopen', 'onmessage', 'onerror', 'onclose'];\n    websocketHandlers.forEach(function (method) {\n      return batchMethod(globalObj.WebSocket.prototype, method);\n    });\n  }\n} // DOM event handlers and HTTP event handlers don't have to be batched\n// event handlers are batched by React\n// HTTP event handlers are usually wrapped by Promises, which is covered above\n\n\nvar COMPONENT = Symbol('owner component');\nvar DUMMY_STATE = {};\n\nfunction view(Comp) {\n  var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n      rawDevtool = _ref.devtool;\n\n  var isStatelessComp = !(Comp.prototype && Comp.prototype.isReactComponent);\n  var BaseComp = isStatelessComp ? Component : Comp;\n  var devtool = rawDevtool ? function (operation) {\n    return rawDevtool(Object.assign({\n      Component: Comp\n    }, operation));\n  } : undefined; // return a HOC which overwrites render, shouldComponentUpdate and componentWillUnmount\n  // it decides when to run the new reactive methods and when to proxy to the original methods\n\n  var ReactiveHOC =\n  /*#__PURE__*/\n  function (_BaseComp) {\n    _inherits(ReactiveHOC, _BaseComp);\n\n    function ReactiveHOC(props, context) {\n      var _this;\n\n      _classCallCheck(this, ReactiveHOC);\n\n      _this = _possibleConstructorReturn(this, _getPrototypeOf(ReactiveHOC).call(this, props, context));\n      _this.state = _this.state || {};\n      _this.state[COMPONENT] = _assertThisInitialized(_assertThisInitialized(_this)); // run a dummy setState to schedule a new render, avoid forceUpdate\n\n      var updater = function updater() {\n        return _this.setState(DUMMY_STATE);\n      }; // create a reactive render for the component\n\n\n      _this.render = observe(_this.render, {\n        scheduler: {\n          add: function add() {\n            return _add(updater);\n          },\n          delete: function _delete() {\n            return remove(updater);\n          }\n        },\n        debugger: devtool,\n        lazy: true\n      });\n      return _this;\n    }\n\n    _createClass(ReactiveHOC, [{\n      key: \"render\",\n      value: function render() {\n        return isStatelessComp ? Comp(this.props, this.context) : _get(_getPrototypeOf(ReactiveHOC.prototype), \"render\", this).call(this);\n      } // react should trigger updates on prop changes, while easyState handles store changes\n\n    }, {\n      key: \"shouldComponentUpdate\",\n      value: function shouldComponentUpdate(nextProps, nextState) {\n        var props = this.props,\n            state = this.state; // respect the case when user prohibits updates\n\n        if (_get(_getPrototypeOf(ReactiveHOC.prototype), \"shouldComponentUpdate\", this) && !_get(_getPrototypeOf(ReactiveHOC.prototype), \"shouldComponentUpdate\", this).call(this, nextProps, nextState)) {\n          devtool && devtool({\n            type: 'render',\n            renderType: 'blocked'\n          });\n          return false;\n        } // return true if it is a reactive render or state changes\n\n\n        if (state !== nextState) {\n          devtool && devtool({\n            type: 'render',\n            renderType: 'reactive'\n          });\n          return true;\n        } // the component should update if any of its props shallowly changed value\n\n\n        var keys = Object.keys(props);\n        var nextKeys = Object.keys(nextProps);\n\n        if (nextKeys.length !== keys.length || nextKeys.some(function (key) {\n          return props[key] !== nextProps[key];\n        })) {\n          devtool && devtool({\n            type: 'render',\n            renderType: 'normal',\n            props: nextProps,\n            oldProps: props\n          });\n          return true;\n        }\n\n        return false;\n      } // add a custom deriveStoresFromProps lifecyle method\n\n    }, {\n      key: \"componentWillUnmount\",\n      value: function componentWillUnmount() {\n        // call user defined componentWillUnmount\n        if (_get(_getPrototypeOf(ReactiveHOC.prototype), \"componentWillUnmount\", this)) {\n          _get(_getPrototypeOf(ReactiveHOC.prototype), \"componentWillUnmount\", this).call(this);\n        } // clean up memory used by Easy State\n\n\n        unobserve(this.render);\n      }\n    }], [{\n      key: \"getDerivedStateFromProps\",\n      value: function getDerivedStateFromProps(props, state) {\n        if (_get(_getPrototypeOf(ReactiveHOC), \"deriveStoresFromProps\", this)) {\n          var _get2;\n\n          // inject all local stores and let the user mutate them directly\n          var stores = mapStateToStores(state);\n\n          (_get2 = _get(_getPrototypeOf(ReactiveHOC), \"deriveStoresFromProps\", this)).call.apply(_get2, [this, props].concat(_toConsumableArray(stores)));\n        } // respect user defined getDerivedStateFromProps\n\n\n        if (_get(_getPrototypeOf(ReactiveHOC), \"getDerivedStateFromProps\", this)) {\n          return _get(_getPrototypeOf(ReactiveHOC), \"getDerivedStateFromProps\", this).call(this, props, state);\n        }\n\n        return null;\n      }\n    }]);\n\n    return ReactiveHOC;\n  }(BaseComp);\n\n  ReactiveHOC.displayName = Comp.displayName || Comp.name; // static props are inherited by class components,\n  // but have to be copied for function components\n\n  if (isStatelessComp) {\n    var _arr = Object.keys(Comp);\n\n    for (var _i = 0; _i < _arr.length; _i++) {\n      var key = _arr[_i];\n      ReactiveHOC[key] = Comp[key];\n    }\n  }\n\n  return ReactiveHOC;\n}\n\nfunction mapStateToStores(state) {\n  // find store properties and map them to their none observable raw value\n  // to do not trigger none static this.setState calls\n  // from the static getDerivedStateFromProps lifecycle method\n  var component = state[COMPONENT];\n  return Object.keys(component).map(function (key) {\n    return component[key];\n  }).filter(isObservable).map(raw);\n}\n\nexport { view, batch };"],"sourceRoot":""}